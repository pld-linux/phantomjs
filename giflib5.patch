https://github.com/ariya/phantomjs/pull/11760
https://github.com/bmanojlovic/phantomjs/commit/f504f5316fe0a170bf41327b1715f806d8592d9a.patch

From f504f5316fe0a170bf41327b1715f806d8592d9a Mon Sep 17 00:00:00 2001
From: Boris Manojlovic <boris.manojlovic@zis.co.rs>
Date: Mon, 18 Nov 2013 08:02:05 +0100
Subject: [PATCH] add giflib5 support to codebase

---
 src/gif/gifwriter.cpp | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

diff --git a/src/gif/gifwriter.cpp b/src/gif/gifwriter.cpp
index c0a010c..5a8647e 100644
--- a/src/gif/gifwriter.cpp
+++ b/src/gif/gifwriter.cpp
@@ -34,6 +34,12 @@
 #include <QImage>
 #include <QFile>
 
+#if defined GIFLIB_MAJOR && GIFLIB_MAJOR >=5
+#define EGifOpenFileName(a, b) EGifOpenFileName(a, b, NULL)
+#define EGifOpen(a, b) EGifOpen(a, b, NULL)
+#define QuantizeBuffer GifQuantizeBuffer
+#endif
+
 static int saveGifBlock(GifFileType *gif, const GifByteType *data, int i)
 {
     QFile *file = (QFile*)(gif->UserData);
@@ -100,9 +106,14 @@ bool exportGif(const QImage &img, const QString &fileName)
         if (qAlpha(colorTable[c]) == 0)
             bgcolor = c;
     }
-    EGifSetGifVersion("87a");
 
+#if defined GIFLIB_MAJOR && GIFLIB_MAJOR >= 5
+    GifFileType *gif = EGifOpen(&file, saveGifBlock);
+    EGifSetGifVersion(gif, false);
+#else
+    EGifSetGifVersion("87a");
     GifFileType *gif = EGifOpen(&file, saveGifBlock);
+#endif
     gif->ImageCount = 1;
     EGifPutScreenDesc(gif, image.width(), image.height(), 256, 0, &cmap);
     if (bgcolor >= 0) {
-- 
1.8.5.5

--- phantomjs-1.9.7/src/gif/gifwriter.cpp~	2014-11-04 21:03:45.000000000 +0100
+++ phantomjs-1.9.7/src/gif/gifwriter.cpp	2014-11-04 21:06:16.042996189 +0100
@@ -128,7 +128,11 @@
         }
     }
 
+#if ((GIFLIB_MAJOR == 5 && GIFLIB_MINOR >= 1) || GIFLIB_MAJOR > 5)
+    EGifCloseFile(gif, NULL);
+#else
     EGifCloseFile(gif);
+#endif
     file.close();
 
     delete [] cmap.Colors;
